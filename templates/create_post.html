<!-- Додавання поста -->
{% extends "base.html" %}

{% block content %}
<div class="post-form-container">
    <h2>{{ title }}</h2>
    <form method="post" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.title.label(class="form-label") }}
            {{ form.title(class="form-input") }}
        </div>

        <div class="form-group">
            {{ form.content.label(class="form-label") }}
            {{ form.content(class="form-textarea") }}
            <input type="file" id="images" name="images" multiple>
            <input type="hidden" id="main_image_index" name="main_image_index">

            <div id="preview"></div>
        </div>

        <div class="form-group">
            {{ form.images.label(class="form-label") }}
            {{ form.images(class="form-control", multiple=True) }}
            {% if post and post.image_filename %}
                <!-- Головне зображення -->
                {% set main_image = post.images|selectattr("is_main")|first %}
                <img id="main-image" src="{{ url_for('static', filename='uploads/' ~ main_image.filename) }}" class="main-image">

                <!-- Галерея -->
                <div class="gallery">
                    {% for img in post.images %}
                        <img src="{{ url_for('static', filename='uploads/' ~ img.filename) }}" 
                            class="thumbnail" 
                            onclick="document.getElementById('main-image').src=this.src;">
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-submit">Зберегти</button>
    </form>
</div>
{% endblock %}



<style>
#preview {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    max-height: 200px; /* обмежуємо висоту прев’ю */
    overflow-y: auto;  /* якщо картинки виходять за висоту, буде скрол */
}

.preview-img {
    width: 100px;
    height: 100px;
    object-fit: cover; /* обрізає, щоб не тягнуло пропорції */
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 5px;
    transition: border 0.2s;
}

.preview-img.main {
    border: 3px solid red;
}
</style>



